FROM python:3-slim as python
RUN apt-get update
RUN apt-get -y install gcc
ENV PYTHONUNBUFFERED=true
RUN pip install poetry

WORKDIR /app
COPY pyproject.toml poetry.lock ./
RUN POETRY_VIRTUALENVS_CREATE=false poetry install
COPY ./src/ /app/src/


ENTRYPOINT ["python"]
CMD ["/app/src/logger.py"]
HEALTHCHECK --interval=1m --retries=2 CMD python /app/src/logger_test.py || exit 1