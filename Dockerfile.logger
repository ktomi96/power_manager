FROM python:3-slim as python
ENV PYTHONUNBUFFERED=true
RUN pip install poetry

WORKDIR /app
COPY pyproject.toml poetry.lock ./
RUN POETRY_VIRTUALENVS_CREATE=false poetry install
COPY ./src/logger /app/src/logger
COPY ./src/test /app/src/test

ENTRYPOINT ["python"]
CMD ["/app/src/logger/logger.py"]
HEALTHCHECK --interval=1m --retries=2 CMD python /app/src/test/logger_test.py || exit 1